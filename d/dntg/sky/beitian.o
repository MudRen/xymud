
#include <room.h>
#include <ansi.h>
inherit ROOM;



void create ()
{
  set ("short", "北天门");
  set ("long", @LONG

这里是天宫的北门。由四大天王之一的魔礼寿负责保守。比起
南天门来，北边可就冷清多了。虽然如此，东天门造的可丝毫
不含糊。鲜红的大门上镶着闪闪发光的铜钉，显得威武非凡。
大力天丁和众天兵，一丝不苟的巡逻着。

LONG);

  set("exits", ([ /* sizeof() == 3 */
  "south"      : __DIR__"jiashan",
  "east"      : __DIR__"tgqn5",
  "west"      : __DIR__"tgqn4",
  "north"      : __FILE__,

]));

  create_door("south", "北天门", "north", DOOR_CLOSED);

  set("objects", ([
  __DIR__"npc/moli-shou"   : 1,
  __DIR__"npc/tian-bing"   : 4,
]));


  setup();
}

int valid_leave(object who,string dir)
{
if ( dir=="north" )  {
           if ( !who->query("obstacle/reward") ) 
                   return notify_fail("你西天取经尚未完成，不能挑战各门派。\n");
           if ( who->query("combat_exp")/10000<100 )
                   return notify_fail("以你现在的能力尚不能挑战各门派。\n");
           if ( !userp(who) )   return 0;
           if ( who->query("新任务/门派挑战/取经注销") )
                   return notify_fail("你想到自己已经将所有的门派挑战过了，不由暗思：还是去取经吧。\n");
           if ( who->query("combat_exp")<8000000 )
                   return notify_fail("你觉得没什么把握，不禁停住了脚步。\n");
           message("channel:rumor",HIM"【小道消息】某人：听说"+who->query("name")+"开始了挑战星月各大门派的修炼。\n"NOR,users());
           who->move("/d/newguai/tianguan/moon");
           return 0;
           }
return ::valid_leave(who,dir);
}

