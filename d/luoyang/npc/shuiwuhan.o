// 雪衣神侯水舞寒 Shuiwuhan.c
// Cracked by 凌惊雪 1-17-2003

#include <ansi.h>
inherit NPC;
inherit F_MASTER;
int ask_killer();
string ask_join();
string ask_cancel();
void create()
{
       	set_name("水舞寒", ({"shui wuhan", "shui", "wuhan"}));
       	set("long", 
HIG"曾凭借一身独步天下的一气贯日月内功闯荡四方，足迹遍布四洲大陆
每个角落，是个默默无闻的英雄。晚年归隐南部洲大唐洛阳神侯府，
收录手下，运筹帷幄，尽剿天下匪徒。独创独门招式屏风四扇门，取
公门六扇之意。\n"NOR);
       	set("title", HIW"雪衣神侯"NOR);
       	set("gender", "男性");
       	set("age", 54);
       	set("attitude", "friendly");
       	set("cor", 30);
       	set("per", 30);
       	set("max_kee", 4500);
       	set("max_gin", 800);
       	set("max_sen", 4500);
       	set("force", 4000);
       	set("max_force", 2000);
       	set("force_factor", 125);
       	set("max_mana", 2000);
       	set("mana", 4000);
       	set("mana_factor", 100);
       	set("combat_exp", 2000000);
       	set_skill("literate", 180);
       	set_skill("unarmed", 250);
       	set_skill("dodge", 250);
       	set_skill("force", 300);
       	set_skill("parry", 250);
   	set_skill("pingfeng", 500);
   	map_skill("unarmed", "pingfeng");
   	map_skill("force", "pingfeng");
   	map_skill("parry", "pingfeng");
   set("inquiry", ([
          "杀手": (: ask_killer :),
          "剿灭": (: ask_killer :),
          "killer": (: ask_killer :),
          "加入": (: ask_join :),
          "join": (: ask_join :),
          "失手": (: ask_cancel :),
]));
set("chat_chance_combat", 90);
set("chat_msg_combat", ({
(: perform_action,"unarmed", "shipo" :),
 }) );
setup();
}
int ask_killer()
{
    	object who=this_player();
    	object ob=this_object();
	int i = (int)who->query("jobmark/killerjob", 1);
	int j = (int)who->query("daemon/pingfeng",1);
    	if (who->query("killerside")=="officer")
    	{
	if ( who->query("combat_exp") < 300000 )
	{
	message_vision("$N对$n悄悄说道："+RANK_D->query_respect(who)+"实战经验不足，这危险的差使不作也罢。\n",this_object(),who);
	return 1;
	}
	if ( i/10 > j)
	{
      	message_vision("$N对$n说道：“"+RANK_D->query_respect(who)+"已经完成不少任务，该去揣摩揣摩你的功夫了。\n",this_object(),who);
      	return 1;
      	}
      	message_vision("$N对$n悄悄说道：“既然"+RANK_D->query_respect(who)+"有心帮忙，"+RANK_D->query_self(ob)+"这里就先代天下百姓谢过了。\n",this_object(),who);
      	message_vision("$N对$n悄悄说道："+"/d/obj/killer/kill"->query_killer(who),this_object(),who);
      	return 1;
	}
	message_vision("$N大怒道：你是消遣本侯来着？\n",this_object(),who);
	return 1;
}
void init()
{
        add_action("do_agree", "agree");
}

string ask_join()
{
	object me=this_player();
	if (!me->query("killerside")) {
		me->set_temp("killerside", 1);
		return ("入得我府，须终生为大唐神侯府效力，你可愿意(agree)？");
	}
	return ("在下不知。\n");
}
string ask_cancel()
{
    	object me=this_player();
	if((int)me->query("mykiller"))
{
      	me->add("combat_exp",-1000);
      	me->add("xyscore",-1);
      	me->add("jobmark/killerjob",-1);
      	me->delete("mykiller");
     	return ("真够窝囊的，神侯府的脸都被你丢光了！");
}
else
{
     	return ("你来消遣我？！");
}
}
int do_agree(string arg)
{
	if(this_player()->query_temp("killerside"))
	{
	message_vision("$N答道：在下愿意效犬马之劳。\n\n", this_player());
	command("say 不错不错，望你他日有所成就！");
	this_player()->set("killerside", "officer");
	this_player()->set("title",HIW"雪衣神捕"NOR);
	this_player()->delete_temp("killerside");
	this_player()->save();
	}
	return 1;
}
int recognize_apprentice(object ob, object who)
{
	int i = (int)this_player()->query_skill("pingfeng", 1);
	int j = (int)this_player()->query_skill("force", 1);
	int k = (int)this_player()->query("daemon/pingfeng",1);
	if ( this_player()->query("killerside") != "officer")
		return notify_fail("你不是神侯府的门下，难以领会屏风四扇门的精髓。\n");
	if ( j < 300)
		return notify_fail("你的内功修为太低，强学这门功夫没用的，小心走火入魔。\n");
       if ( i >= 500)
		return notify_fail("你的屏风四扇门已经够强了，很难再通过学习来进步了。\n");
	if ( i >= k)
		return notify_fail("你的实战能力不够，强学何用，只有在战斗中才能领悟更高深的武学。\n");

	return 1;
}
